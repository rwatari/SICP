;;; Tables


(define (lookup key table)
  (let ((record (assoc key (cdr table))))
    ;;; record is key-entry pair
    (if record
        (cdr record)
        #f)))

(define (assoc key records)
  ;;; recursively searches for matching key in table
  (cond ((null? records) false)
        ((equal? key (caar records)) (car records))
        (else (assoc key (cdr records)))))

(define (insert! key value table)
  (let ((record (assoc key (cdr table))))
    (if record
        (set-cdr! record value) ; If record exists, change value of entry
        (set-cdr! table         ; Otherwise insert key-entry pair
                  (cons (cons key value)
                        (cdr table))))))
(define (make-table)
  (list '*table*))